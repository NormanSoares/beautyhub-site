<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    <title data-translate-key="checkout_title">Checkout - 24K Anti-Aging Kit | 67 Beauty Hub</title>
    <link rel="stylesheet" href="../../styles.css">
    <!-- Scripts do Sistema de Processamento (carregar primeiro) -->
    <script src="../../js/supplier-order-processor.js"></script>
    <script src="../../js/payment-gateway.js"></script>
    <script src="../../js/pix-generator.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="../../js/aliexpress-integration.js"></script>
    <!-- Product Variation Mapping System -->
    <script src="../../js/product-variation-mapping.js"></script>
    <!-- Global Translation System -->
    <script src="../../js/language-controller.js"></script>
    <!-- PIX Payment System -->
    <script src="../../js/pix-generator.js"></script>
    <!-- PayPal SDK -->
    <!-- PayPal SDK will be loaded dynamically with correct locale -->

    <!-- Country/Currency System Variables -->
    <script>

        // Function to format price for display
        function formatPrice(price) {
            const currencyInfo = exchangeRates[currentCurrency];
            if (!currencyInfo) return `$${price.toFixed(2)}`;

            const convertedPrice = price * currencyInfo.rate;
            return new Intl.NumberFormat(currencyInfo.locale, {
                style: 'currency',
                currency: currencyInfo.currency
            }).format(convertedPrice);
        }

        // Function to update currency display (if needed)
        function updateCurrencyDisplay() {
            // This function can be extended to update price displays throughout the page
            console.log('Currency updated to:', currentCurrency);
        }
    </script>
    <style>
        body { background: #f0e6d2; }
        .checkout-container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; margin-top: 50px; }
        .checkout-layout { display: flex; flex-direction: column; gap: 20px; }
        .unified-section { background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: start; }
        .checkout-bottom {
            display: grid !important;
            grid-template-columns: 2fr 1fr !important;
            gap: 20px !important;
            align-items: start !important;
        }
        .form-section { background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px; }
        .checkout-header { text-align: center; margin-bottom: 40px; grid-column: 1 / -1; }
        .checkout-header h1 { color: #d4af37; font-size: 2.5rem; margin-bottom: 10px; }
        .product-summary { background: #f8f9fa; padding: 30px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .product-image { max-width: 100%; height: 450px; object-fit: cover; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.15); margin: 0 auto 20px; display: block; }
        .product-details h3 { color: #333; font-size: 1.8rem; margin-bottom: 15px; }
        .product-details p { color: #666; margin-bottom: 20px; font-size: 1.1rem; line-height: 1.6; }
        .offer-options { display: flex; flex-direction: column; gap: 20px; margin-bottom: 30px; }
        .offer-option { border: 2px solid #e0e0e0; border-radius: 12px; padding: 25px; cursor: pointer; transition: all 0.3s ease; position: relative; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .offer-option:hover { border-color: #d4af37; transform: translateY(-2px); box-shadow: 0 8px 25px rgba(212, 175, 55, 0.15); }
        .offer-option.selected { border-color: #d4af37; background: linear-gradient(135deg, #fff9e6, #fff); box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2); transform: translateY(-2px); }
        .offer-checkbox { position: absolute; top: 15px; left: 15px; width: 20px; height: 20px; accent-color: #d4af37; cursor: pointer; }
        .offer-option.has-checkbox { padding-left: 50px; }
        .offer-option.has-checkbox .option-header { margin-left: 10px; }
        .option-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .offer-option h4 { color: #333; font-size: 1.3rem; margin: 0; }
        .offer-option .price { font-size: 1.5rem; font-weight: 700; color: #d4af37; }
        .offer-option .description { color: #666; font-size: 0.95rem; margin-bottom: 10px; }
        .offer-option .discount {
            background: #d4af37;
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            position: absolute;
            top: -8px;
            right: -8px;
        }
        .summary-section { background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 20px; position: sticky; top: 20px; margin-bottom: 20px; }
        .summary-section h3 { color: #333; margin-bottom: 20px; font-size: 1.4rem; text-align: center; border-bottom: 2px solid #d4af37; padding-bottom: 10px; }
        .form-section .form-section { margin-bottom: 30px; }
        .form-section h3 { color: #333; margin-bottom: 20px; font-size: 1.3rem; border-bottom: 2px solid #d4af37; padding-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .form-section h3 i { color: #d4af37; font-size: 1.2rem; }
        .form-row { display: flex; gap: 20px; margin-bottom: 20px; }
        .form-group { flex: 1; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #333; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: all 0.3s ease; background: white; color: #333; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #d4af37; box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1); transform: translateY(-1px); }
        .checkout-summary { background: #f8f9fa; padding: 25px; border-radius: 10px; margin-bottom: 30px; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .summary-row.total { border-top: 2px solid #d4af37; padding-top: 15px; margin-top: 15px; font-size: 1.2rem; font-weight: 700; color: #d4af37; }
        .checkout-btn { width: 100%; background: linear-gradient(135deg, #d4af37, #b8941f); color: white; border: none; padding: 15px; font-size: 1.2rem; font-weight: 600; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); display: flex; align-items: center; justify-content: center; gap: 10px; }
        .checkout-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4); }
        .back-link { text-align: center; margin-top: 20px; }
        .back-link a { color: #d4af37; text-decoration: none; font-weight: 500; }
        @media (max-width: 768px) { 
            .checkout-layout { grid-template-columns: 1fr; gap: 20px; } 
            .form-row { flex-direction: column; } 
            .unified-section { grid-template-columns: 1fr; gap: 20px; } 
            .summary-section { position: static; } 
            .product-image { height: 350px; }
        }
        
        
        
        @media (max-width: 480px) {
            .product-image { height: 280px; }
        }
        
        /* Galeria Styles */
        .product-gallery-section {
            margin: 40px 0;
            width: 100%;
            text-align: center;
            grid-column: 1 / -1; /* Ocupa toda a largura do grid */
        }
        
        .gallery-main {
            position: relative;
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .gallery-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(212, 175, 55, 0.9);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .gallery-nav-btn.prev-btn {
            left: 15px;
        }
        
        .gallery-nav-btn.next-btn {
            right: 15px;
        }
        
        .gallery-nav-btn:hover {
            background: rgba(184, 148, 31, 0.95);
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
        
        .gallery-nav-btn:disabled {
            background: rgba(204, 204, 204, 0.7);
            cursor: not-allowed;
            transform: translateY(-50%);
            box-shadow: none;
        }
        
        .gallery-main-image {
            width: 100%;
            height: auto;
            max-height: 600px;
            object-fit: contain;
            display: block;
            transition: transform 0.5s ease-in-out, opacity 0.3s ease;
        }
        
        .gallery-indicators {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .gallery-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .gallery-indicator.active {
            background: #d4af37;
            transform: scale(1.2);
        }
        
        .gallery-indicator:hover {
            background: #d4af37;
            transform: scale(1.1);
        }
        
        /* Animações da galeria */
        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutLeft {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(-100%); opacity: 0; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .gallery-main-image.slide-in-left {
            animation: slideInLeft 0.5s ease-in-out;
        }
        
        .gallery-main-image.slide-in-right {
            animation: slideInRight 0.5s ease-in-out;
        }
        
        .gallery-main-image.slide-left {
            animation: slideOutLeft 0.5s ease-in-out;
        }
        
        .gallery-main-image.slide-right {
            animation: slideOutRight 0.5s ease-in-out;
        }
        
        /* Responsivo para galeria */
        @media (max-width: 768px) {
            .gallery-nav-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .gallery-nav-btn.prev-btn {
                left: 10px;
            }
            
            .gallery-nav-btn.next-btn {
                right: 10px;
            }
            
            .gallery-main {
                width: 100%;
            }
            
            .gallery-main-image {
                height: auto;
                max-height: 400px;
            }
            
            .product-gallery-section {
                margin: 20px 0;
            }
        }
        
        /* Flag dropdown styles removed - currency detection is now automatic */
        
        /* Reviews Section Styles */
        .reviews-section {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
        }
        
        .reviews-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .reviews-header h3 {
            color: #d4af37;
            font-size: 2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .reviews-header p {
            color: #666;
            font-size: 1.1rem;
        }
        
        .reviews-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .review-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .review-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(212, 175, 55, 0.15);
            border-color: #d4af37;
        }
        
        .clickable-review {
            cursor: pointer;
        }
        
        .clickable-review:hover {
            transform: translateY(-5px);
        }
        
        .review-image {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .review-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37, #b8941f);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #fff;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
            margin: 0 auto;
        }
        
        .review-avatar i {
            font-size: 2.2rem;
            color: white;
        }
        
        .review-stars {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-bottom: 15px;
        }
        
        .review-stars i {
            color: #ffd700;
            font-size: 1.1rem;
        }
        
        .review-stars i.far {
            color: #ddd;
        }
        
        .review-text {
            color: #333;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 10px;
            font-style: italic;
            text-align: center;
        }
        
        .review-author {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .review-author strong {
            color: #333;
            font-size: 1.1rem;
        }
        
        .review-date {
            color: #888;
            font-size: 0.9rem;
        }

        .review-image img:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }

        
        .reviews-stats {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #f0e6d2;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #d4af37;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Background overlay for reviews section */
        .reviews-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            z-index: 1;
        }
        
        .reviews-section > * {
            position: relative;
            z-index: 2;
        }
        
        .reviews-header h3 {
            color: #d4af37;
            font-size: 2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .reviews-header p {
            color: #666;
            font-size: 1.1rem;
        }
        
        .reviews-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .review-item {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .review-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            border-color: #d4af37;
        }
        
        
        .review-avatar i {
            color: white;
            font-size: 2rem;
        }
        
        .review-content {
            text-align: center;
        }
        
        .review-stars {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-bottom: 15px;
        }
        
        .review-stars i {
            color: #d4af37;
            font-size: 1.2rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .review-text {
            color: #555;
            font-style: italic;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 1rem;
        }
        
        .review-author {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .review-author strong {
            color: #333;
            font-size: 1.1rem;
        }
        
        .review-date {
            color: #888;
            font-size: 0.9rem;
        }

        .review-image img:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }

        
        .reviews-stats {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #f0e6d2;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #d4af37;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Review Modal Styles */
        .review-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .review-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            cursor: pointer;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.8);
            transition: transform 0.3s ease;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        .review-modal.show .modal-content {
            transform: scale(1);
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0e6d2;
        }
        
        .modal-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #d4af37, #b8941f);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .modal-avatar i {
            color: white;
            font-size: 1.5rem;
        }
        
        .modal-author-info {
            flex: 1;
        }
        
        .modal-author-info h3 {
            color: #333;
            margin: 0 0 8px 0;
            font-size: 1.3rem;
        }
        
        .modal-stars {
            display: flex;
            gap: 2px;
            margin-bottom: 5px;
        }
        
        .modal-stars i {
            color: #d4af37;
            font-size: 1.1rem;
        }
        
        .modal-date {
            color: #888;
            font-size: 0.9rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #888;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: #f0e6d2;
            color: #d4af37;
        }
        
        .modal-body {
            margin-top: 20px;
        }
        
        .modal-review-text {
            color: #555;
            font-style: italic;
            line-height: 1.7;
            font-size: 1.1rem;
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #d4af37;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .reviews-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .reviews-stats {
                flex-direction: column;
                gap: 20px;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .modal-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .flag-dropdown-container {
                margin-top: 20px;
                margin-left: 0;
            }
            
            .flag-dropdown {
                padding: 10px 15px;
            }
            
            .selected-flag {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <div class="logo-container">
                    <img src="../../Logo.png" alt="67 Beauty Hub" class="logo-image">
                    <div class="logo-text"><span class="logo-brand">67 BEAUTY HUB</span></div>
                </div>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="../../index.html" class="nav-link">Início</a></li>
                <li class="nav-item"><a href="index.html#products" class="nav-link">Products</a></li>
                <li class="nav-item"><a href="index.html#about" class="nav-link">Sobre</a></li>
                <li class="nav-item"><a href="index.html#contact" class="nav-link">Contato</a></li>
            </ul>
            
            <!-- Currency automatically detected based on browser language -->
            </div>
        </div>
    </nav>

    <div class="checkout-container">
        <div class="checkout-header">
            <h1><i class="fas fa-shopping-cart"></i> Checkout</h1>
            <p>Choose your offer and complete your order securely</p>
        </div>

        <div class="checkout-layout">
            <div class="unified-section">
                <div class="product-info">
                    <div class="product-summary">
                        <img src="Apresentação.png" alt="LAIKOU Skincare" class="product-image" id="mainProductImage">
                        <div class="product-details">
                            <h3 data-translate-key="product_laiou_skincare">LAIKOU Skincare</h3>
                            <p data-translate-key="product_description">Skincare line inspired by the golden cherry blossom, with nourishing formulas that hydrate, illuminate and enhance the natural beauty of the skin.</p>
                        </div>
                    </div>
                </div>

                <div class="offers-info">
                    <h3 style="color: #333; margin-bottom: 20px; text-align: center;" data-translate-key="offer_basic_title"><i class="fas fa-gift"></i> Basic Offer</h3>
                    
                    <div class="offer-options">
                        <div class="offer-option selected" data-option="basic" style="padding-left: 20px;">
                            <div class="option-header">
                                <h4 data-translate-key="product_laiou_skincare">LAIKOU Skincare</h4>
                                <div class="price" id="offerPrice">$5.99</div>
                            </div>
                            <div class="discount" data-translate-key="discount_badge">70% OFF</div>
                            <div class="description" data-translate-key="offer_basic_description">Cansada de pele sem brilho e ressecada? LAIKOU hidrata, nutre e devolve a maciez natural, deixando sua pele mais saudável e radiante todos os dias.</div>
                            
                            <!-- Seleção de tamanho e cor com imagens -->
                            <div class="color-selection" style="margin: 15px 0;">
                                <div class="color-options" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px;">
                                    <!-- Gold Snail -->
                                    <div class="color-option" style="display: flex; flex-direction: column; align-items: center; padding: 0; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-size: 1.1rem; text-align: center; min-height: 220px; overflow: hidden;" data-color="gold-snail">
                                        <div class="color-image-container" style="width: 100%; height: 200px; border-radius: 0; overflow: hidden; border: none; cursor: pointer; transition: all 0.3s ease; flex: 1;">
                                            <img src="Escolha/Gold Snail.png" alt="Gold Snail" style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                        <div style="font-weight: 600; color: #333; padding: 15px; background: #fff;">Gold Snail</div>
                                    </div>

                                    <!-- Sakura -->
                                    <div class="color-option" style="display: flex; flex-direction: column; align-items: center; padding: 0; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-size: 1.1rem; text-align: center; min-height: 220px; overflow: hidden;" data-color="sakura">
                                        <div class="color-image-container" style="width: 100%; height: 200px; border-radius: 0; overflow: hidden; border: none; cursor: pointer; transition: all 0.3s ease; flex: 1;">
                                            <img src="Escolha/Sakura.png" alt="Sakura" style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                        <div style="font-weight: 600; color: #333; padding: 15px; background: #fff;">Sakura</div>
                                    </div>

                                    <!-- Vitamin C -->
                                    <div class="color-option" style="display: flex; flex-direction: column; align-items: center; padding: 0; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-size: 1.1rem; text-align: center; min-height: 220px; overflow: hidden;" data-color="vitamin-c">
                                        <div class="color-image-container" style="width: 100%; height: 200px; border-radius: 0; overflow: hidden; border: none; cursor: pointer; transition: all 0.3s ease; flex: 1;">
                                            <img src="Escolha/Vitamin C.png" alt="Vitamin C" style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                        <div style="font-weight: 600; color: #333; padding: 15px; background: #fff;">Vitamin C</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Galeria de Imagens -->
                <div class="product-gallery-section">
                    <div class="simple-gallery">
                        <div class="gallery-main">
                            <button class="gallery-nav-btn prev-btn" id="prevBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <img src="Galeria/Screenshot 2025-09-24 104420.png" alt="LAIKOU Skincare" class="gallery-main-image" id="galleryMainImage">
                            <button class="gallery-nav-btn next-btn" id="nextBtn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="gallery-indicators" id="galleryIndicators">
                        <!-- Indicators will be generated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="checkout-bottom">
                <div class="form-section">
                    <form class="checkout-form" id="checkoutForm">
                        <h3><i class="fas fa-user"></i> <span data-translate-key="customer_info">Customer Information</span></h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="firstName" data-translate-key="first_name">First Name *</label>
                                    <input type="text" id="firstName" name="firstName" required>
                                </div>
                                <div class="form-group">
                                    <label for="lastName" data-translate-key="last_name">Last Name *</label>
                                    <input type="text" id="lastName" name="lastName" required>
                            </div>
                        </div>

                            <div class="form-group">
                                <label for="email" data-translate-key="email_label">Email *</label>
                                <input type="email" id="email" name="email" required placeholder="seu@email.com">
                            </div>
                    
                    <div class="form-group">
                                <label for="phone" data-translate-key="phone_label">Phone *</label>
                                <input type="tel" id="phone" name="phone" required placeholder="+1 (555) 123-4567">
                            </div>

                            <h3><i class="fas fa-truck"></i> <span data-translate-key="shipping_info">Shipping Information</span></h3>
                            
                            <div class="form-group">
                                <label for="address" data-translate-key="address_label">Address *</label>
                                <textarea id="address" name="address" rows="3" required placeholder="Street address, apartment, suite, etc."></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="city" data-translate-key="city_label">City *</label>
                                    <input type="text" id="city" name="city" required>
                                </div>
                                <div class="form-group">
                                    <label for="state" data-translate-key="state_label">State/Province *</label>
                                    <input type="text" id="state" name="state" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="zipCode" data-translate-key="zip_code_label">ZIP/Postal Code *</label>
                                    <input type="text" id="zipCode" name="zipCode" required>
                                </div>
                                <div class="form-group">
                                    <label for="country" data-translate-key="country_label">Country *</label>
                                    <select id="country" name="country" required>
                                        <option value="" data-translate-key="select_country">Select Country</option>
                                        <option value="US" data-translate-key="country_us">United States</option>
                                        <option value="BR" data-translate-key="country_br">Brazil</option>
                                        <option value="PT" data-translate-key="country_pt">Portugal</option>
                                        <option value="CA" data-translate-key="country_ca">Canada</option>
                                        <option value="GB" data-translate-key="country_gb">United Kingdom</option>
                                        <option value="DE" data-translate-key="country_de">Germany</option>
                                        <option value="FR" data-translate-key="country_fr">France</option>
                                        <option value="ES" data-translate-key="country_es">Spain</option>
                                        <option value="IT" data-translate-key="country_it">Italy</option>
                                        <option value="AU" data-translate-key="country_au">Australia</option>
                        </select>
                                </div>
                    </div>

                    <div class="form-group">
                                <label for="observations" data-translate-key="observations_label">Order Notes (optional)</label>
                                <textarea id="observations" name="observations" rows="3" placeholder="Any special instructions for your order?"></textarea>
                    </div>

                            <h3><i class="fas fa-credit-card"></i> <span data-translate-key="payment_method">Payment Method</span></h3>
                            
                            <div class="form-group">
                                <label for="paymentMethod" data-translate-key="payment_method_label">Payment Method *</label>
                                <select id="paymentMethod" name="paymentMethod" required>
                                    <option value="" data-translate-key="select_option">Select</option>
                                    <option value="paypal" data-translate-key="paypal_option">PayPal</option>
                                    <option value="pix" id="pix-option" style="display: none;" data-translate-key="pix_option">PIX (Brazil only)</option>
                                    <option value="stripe" id="stripe-option" style="display: none;" data-translate-key="stripe_option">Credit Card (Stripe)</option>
                                </select>
                            </div>

                    <div id="paypal-payment-button" style="display: none;"></div>
                    <div id="pix-payment-info" style="display: none;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border: 2px solid #d4af37; text-align: center;">
                                    <h4 style="color: #d4af37; margin-bottom: 15px;"><i class="fas fa-qrcode"></i> <span data-translate-key="pix_payment">PIX Payment</span></h4>
                                    <p style="color: #666; margin-bottom: 15px;" data-translate-key="pix_payment_info">After confirming your order, you will receive PIX payment instructions by email.</p>
                            <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd;">
                                        <strong data-translate-key="pix_key">PIX Key:</strong> contato@67beautyhub.com
                            </div>
                        </div>
                    </div>
                            
                            <div id="stripe-payment-info" style="display: none;">
                                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border: 2px solid #d4af37; text-align: center;">
                                    <h4 style="color: #d4af37; margin-bottom: 15px;"><i class="fas fa-credit-card"></i> <span data-translate-key="stripe_payment">Credit Card Payment</span></h4>
                                    <p style="color: #666; margin-bottom: 15px;" data-translate-key="stripe_payment_info">Secure payment processing with Stripe. Your card information is encrypted and secure.</p>
                                </div>
                            </div>

                        <button type="submit" class="checkout-btn">
                            <i class="fas fa-check"></i> Confirm Order
                        </button>
                    </form>
                </div>

                <div class="summary-section">
                    <h3><i class="fas fa-receipt"></i> <span data-translate-key="order_summary">Order Summary</span></h3>
                    <div class="checkout-summary">
                        <div id="selectedOffers"></div>
                        <div class="summary-row total">
                            <span data-translate-key="total">Total</span>
                            <span id="totalAmount">$5.99</span>
                        </div>
                        
                        <!-- Currency automatically detected based on browser language -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const offers = {
            'gold-snail': { 
                name: 'Gold Snail', 
                price: 5.99, 
                prices: { USD: 5.99, BRL: 31.15, EUR: 5.51 },
                discount: 0, 
                shipping: 0 
            },
            'sakura': { 
                name: 'Sakura', 
                price: 5.99, 
                prices: { USD: 5.99, BRL: 31.15, EUR: 5.51 },
                discount: 0, 
                shipping: 0 
            },
            'vitamin-c': { 
                name: 'Vitamin C', 
                price: 5.99, 
                prices: { USD: 5.99, BRL: 31.15, EUR: 5.51 },
                discount: 0, 
                shipping: 0 
            }
        };

        let selectedOffers = ['gold-snail'];
        let selectedColor = 'gold-snail';

        // Color selection logic
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', function() {
                // Remove selected class from all options
                document.querySelectorAll('.color-option').forEach(opt => {
                    opt.classList.remove('selected');
                    opt.style.borderColor = '#e0e0e0';
                });
                
                // Add selected class to clicked option
                this.classList.add('selected');
                this.style.borderColor = '#d4af37';
                
                // Update selected color and price
                selectedColor = this.dataset.color;
                const offer = offers[selectedColor];
                if (offer) {
                    // Converter preço para a moeda do cabeçalho
                    let convertedPrice = offer.price;
                    let headerCurrencySymbol = '$';
                    
                    if (headerCurrency === 'BRL') {
                        convertedPrice = offer.price * 5.2;
                        headerCurrencySymbol = 'R$';
                    } else if (headerCurrency === 'EUR') {
                        convertedPrice = offer.price * 0.92;
                        headerCurrencySymbol = '€';
                    }
                    
                    document.getElementById('offerPrice').textContent = `${headerCurrencySymbol}${convertedPrice.toFixed(2)}`;
                    selectedOffers = [selectedColor];
                    updateOrderSummary();
                    
                    // Update main product image with selected product image
                    const selectedImage = this.querySelector('img').src;
                    const mainProductImage = document.getElementById('mainProductImage');
                    if (mainProductImage) {
                        mainProductImage.src = selectedImage;
                        mainProductImage.alt = offer.name;
                    }
                }
            });
        });

        function updateOrderSummary() {
            const selectedOffersContainer = document.getElementById('selectedOffers');
            let total = 0;
            
            // Obter símbolo da moeda do resumo
            let summaryCurrencySymbol = '$';
            if (summaryCurrency === 'BRL') {
                summaryCurrencySymbol = 'R$';
            } else if (summaryCurrency === 'EUR') {
                summaryCurrencySymbol = '€';
            }
            
            // Obter o kit selecionado
            const selectedOption = document.querySelector('.color-option.selected');
            if (selectedOption) {
                const selectedColor = selectedOption.dataset.color;
                const offer = offers[selectedColor];
                
                if (offer) {
                    const discountAmount = (offer.price * offer.discount / 100);
                    const offerTotal = offer.price - discountAmount;
                    total += offerTotal;

                    // Converter preço para a moeda do resumo
                    let convertedOfferTotal = offerTotal;
                    if (summaryCurrency === 'BRL') {
                        convertedOfferTotal = offerTotal * 5.2;
                    } else if (summaryCurrency === 'EUR') {
                        convertedOfferTotal = offerTotal * 0.92;
                    }

                    // Get translated offer name - no need to show color for this product
                    let translatedOfferName = offer.name;
                    
                    selectedOffersContainer.innerHTML = `
                        <div class="summary-row">
                            <span>${translatedOfferName}</span>
                            <span>${summaryCurrencySymbol}${convertedOfferTotal.toFixed(2)}</span>
                        </div>
                    `;
                }
            }

            // Converter total para a moeda do resumo
            let convertedTotal = total;
            if (summaryCurrency === 'BRL') {
                convertedTotal = total * 5.2;
            } else if (summaryCurrency === 'EUR') {
                convertedTotal = total * 0.92;
            }

            const totalElement = document.getElementById('totalAmount');
            if (totalElement) {
                totalElement.textContent = `${summaryCurrencySymbol}${convertedTotal.toFixed(2)}`;
            }
        }

        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const orderData = {};
            formData.forEach((value, key) => {
                orderData[key] = value;
            });
            
            orderData.selectedOffers = selectedOffers;
            orderData.offerNames = selectedOffers.map(key => offers[key].name);
            
            let total = 0;
            selectedOffers.forEach(offerKey => {
                const offer = offers[offerKey];
                const discountAmount = (offer.price * offer.discount / 100);
                const offerTotal = offer.price - discountAmount;
                total += offerTotal;
            });
            
            orderData.total = total;
            
            const selectedOption = document.querySelector('.color-option.selected');
            const offerName = selectedOption ? offers[selectedOption.dataset.color].name : 'LAIKOU Skincare';
            // Sistema de popup de celebração será usado via supplier-order-processor.js
        });





        // Variáveis para moedas separadas
        let headerCurrency = 'USD'; // Moeda do dropdown do cabeçalho
        let summaryCurrency = 'USD'; // Moeda do seletor do resumo
        currentCurrency = 'USD'; // Moeda atual para PayPal (usa a do resumo)

        // Função para converter preços baseado na moeda do cabeçalho
        function convertPrices(currency) {
            const basePrice = 5.99; // Preço base em USD
            let convertedPrice;
            let currencySymbol;
            
            // Atualizar moeda do cabeçalho
            headerCurrency = currency;
            
            switch(currency) {
                case 'BRL':
                    convertedPrice = (basePrice * 5.2).toFixed(2); // Taxa aproximada USD para BRL
                    currencySymbol = 'R$';
                    break;
                case 'EUR':
                    convertedPrice = (basePrice * 0.92).toFixed(2); // Taxa aproximada USD para EUR
                    currencySymbol = '€';
                    break;
                default: // USD
                    convertedPrice = basePrice.toFixed(2);
                    currencySymbol = '$';
                    break;
            }
            
            // Atualizar preço na oferta básica
            const offerPrice = document.getElementById('offerPrice');
            if (offerPrice) {
                offerPrice.textContent = `${currencySymbol}${convertedPrice}`;
            }
        }

        // Função para converter preços do resumo baseado na moeda do resumo
        function convertSummaryPrices(currency) {
            summaryCurrency = currency;
            currentCurrency = currency; // Atualizar moeda atual para PayPal
            updateOrderSummary();
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Set first color option as selected by default
            const firstColorOption = document.querySelector('.color-option');
            if (firstColorOption) {
                firstColorOption.classList.add('selected');
                firstColorOption.style.borderColor = '#d4af37';
                
                // Update main product image with first product image
                const firstProductImage = firstColorOption.querySelector('img').src;
                const mainProductImage = document.getElementById('mainProductImage');
                if (mainProductImage) {
                    mainProductImage.src = firstProductImage;
                    mainProductImage.alt = 'Gold Snail';
                }
            }
            
            
            // Sistema de galeria de produtos
            function initializeProductGallery() {
                const galleryImages = [
                    { src: 'Galeria/Screenshot 2025-09-24 104420.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 104514.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105056.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105201.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105300.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105352.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105619.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105637.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 105812.png' },
                    { src: 'Galeria/Screenshot 2025-09-24 142634.png' }
                ];
                
                let currentImageIndex = 0;
                const mainImage = document.getElementById('galleryMainImage');
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const indicatorsContainer = document.getElementById('galleryIndicators');
                
                // Criar indicadores
                galleryImages.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = 'gallery-indicator';
                    if (index === 0) indicator.classList.add('active');
                    indicator.addEventListener('click', () => goToImage(index));
                    indicatorsContainer.appendChild(indicator);
                });
                
                function updateImage(direction = null) {
                    const currentImage = galleryImages[currentImageIndex];
                    
                    // Aplicar transição de saída
                    if (direction === 'next') {
                        mainImage.classList.add('slide-right');
                    } else if (direction === 'prev') {
                        mainImage.classList.add('slide-left');
                    }
                    
                    setTimeout(() => {
                        mainImage.src = currentImage.src;
                        mainImage.alt = `LAIKOU Skincare - Imagem ${currentImageIndex + 1}`;
                        
                        // Aplicar transição de entrada
                        if (direction === 'next') {
                            mainImage.classList.add('slide-in-left');
                        } else if (direction === 'prev') {
                            mainImage.classList.add('slide-in-right');
                        }
                        
                        // Remover classes de transição após a animação
                        setTimeout(() => {
                            mainImage.classList.remove('slide-left', 'slide-right', 'slide-in-left', 'slide-in-right');
                        }, 500);
                    }, 250);
                    
                    // Atualizar indicadores
                    const indicators = document.querySelectorAll('.gallery-indicator');
                    indicators.forEach((indicator, index) => {
                        indicator.classList.toggle('active', index === currentImageIndex);
                    });
                    
                    // Atualizar botões
                    prevBtn.disabled = currentImageIndex === 0;
                    nextBtn.disabled = currentImageIndex === galleryImages.length - 1;
                }
                
                function goToImage(index) {
                    currentImageIndex = index;
                    updateImage();
                }
                
                function nextImage() {
                    if (currentImageIndex < galleryImages.length - 1) {
                        currentImageIndex++;
                        updateImage('next');
                    }
                }
                
                function prevImage() {
                    if (currentImageIndex > 0) {
                        currentImageIndex--;
                        updateImage('prev');
                    }
                }
                
                // Event listeners
                nextBtn.addEventListener('click', nextImage);
                prevBtn.addEventListener('click', prevImage);
                
                // Manual navigation only - no automatic slideshow
                // Users can navigate using buttons and indicators at their own pace
            }
            
            // Inicializar galeria
            initializeProductGallery();
            
            // Sistema de reviews clicáveis
            const clickableReviews = document.querySelectorAll('.clickable-review');
            clickableReviews.forEach((review, index) => {
                review.addEventListener('click', function() {
                    const author = this.getAttribute('data-author');
                    const date = this.getAttribute('data-date');
                    const stars = this.getAttribute('data-stars');
                    const reviewText = this.querySelector('.review-text').textContent.replace(/"/g, '');
                    openReviewModal(author, date, stars, reviewText);
                });
            });
            
            updateOrderSummary();
            
            // Event listener para o seletor de moeda do resumo (independente)
            const summaryCurrencySelector = document.getElementById('summaryCurrencySelector');
            if (summaryCurrencySelector) {
                // Set initial currency based on detected currency
                summaryCurrency = currentCurrency;
                summaryCurrencySelector.value = currentCurrency;
                console.log('Summary currency initialized to:', summaryCurrency);
                
                summaryCurrencySelector.addEventListener('change', function() {
                    const selectedCurrency = this.value;
                    console.log('Summary currency changed to:', selectedCurrency);
                    
                    // Converter apenas os preços do resumo
                    convertSummaryPrices(selectedCurrency);
                });
            }
        });
    </script>

    <!-- Reviews Section (moved to end) -->
    <div class="reviews-section" style="margin: 40px auto; max-width: 1200px; padding: 40px 20px; background-image: url('Background das reviews.png'); background-size: cover; background-position: center; background-repeat: no-repeat; border-radius: 15px; position: relative;">
        <div class="reviews-header">
            <h3 data-translate-key="reviews_title"><i class="fas fa-star"></i> What our customers are saying</h3>
            <p data-translate-key="reviews_subtitle">More than 1,400 satisfied customers with our products</p>
            
            <!-- Botão para adicionar review -->
            <div style="margin-top: 20px;">
                <button id="addReviewBtn" style="background: #d4af37; color: white; border: none; padding: 12px 24px; border-radius: 25px; font-size: 16px; cursor: pointer; transition: all 0.3s ease;">
                    <i class="fas fa-plus"></i> Add Your Review
                </button>
            </div>
        </div>
        
        <div class="reviews-container">
                <div class="review-item clickable-review"
                 data-review-id="customer1"
                 data-author="Satisfied Customer"
                 data-date="15 days ago"
                 data-stars="5">
                <div class="review-image">
                    <img src="Reviews/Upload 3.png" alt="Review Image" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                </div>
                <div class="review-content">
                    <div class="review-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="review-text">"Excellent product! Exceeded my expectations. Amazing quality and fast delivery. I recommend it to everyone!"</p>
                    <div class="review-author">
                        <strong>Satisfied Customer</strong>
                        <span class="review-date">Verified Purchase - 15 days ago</span>
                    </div>
                </div>
            </div>

            <div class="review-item clickable-review"
                 data-author="Maria Silva"
                 data-date="1 week ago"
                 data-stars="5">
                <div class="review-image">
                    <img src="Reviews/Upload 1.png" alt="Review Image" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                </div>
                <div class="review-content">
                    <div class="review-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="review-text">"I love it 10 out of 10"</p>
                    <div class="review-author">
                        <strong>Maria Silva</strong>
                        <span class="review-date">Verified Purchase - 1 week ago</span>
                    </div>
                </div>
            </div>

            <div class="review-item clickable-review"
                 data-author="Marie"
                 data-date="2 weeks ago"
                 data-stars="4.5">
                <div class="review-image">
                    <img src="Reviews/Upload da Marie.png" alt="Review Image" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                </div>
                <div class="review-content">
                    <div class="review-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <p class="review-text">"Moisturizing, there is no allergic reaction that is great. I have a problem with sensitive skin. The silk fit, face cream too, for eyes. Well, I haven't noticed any effect yet, a small size, how will it work for a trial, or will I order more - more give, knife no. Good price and fast delivery (about a week NP)"</p>
                    <div class="review-author">
                        <strong>Marie</strong>
                        <span class="review-date">Verified Purchase - 2 weeks ago</span>
                    </div>
                </div>
            </div>

            <div class="review-item clickable-review"
                 data-author="Jessica"
                 data-date="1 week ago"
                 data-stars="5">
                <div class="review-image">
                    <img src="Reviews/Upload 5.png" alt="Review Image" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
                </div>
                <div class="review-content">
                    <div class="review-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="review-text">"Excellent, left my skin well hydrated"</p>
                    <div class="review-author">
                        <strong>Jessica</strong>
                        <span class="review-date">Verified Purchase - 1 week ago</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="reviews-stats">
            <div class="stat-item">
                <div class="stat-number">4.8</div>
                <div class="stat-label" data-translate-key="average_rating">Average Rating</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">1,427</div>
                <div class="stat-label" data-translate-key="reviews">Reviews</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">98%</div>
                <div class="stat-label" data-translate-key="would_recommend">Would Recommend</div>
            </div>
        </div>

        <!-- Add Review Section (for logged in users only) -->
        <div class="add-review-section" id="addReviewSection" style="display: none;">
            <!-- Content will be inserted dynamically by JavaScript -->
        </div>
    </div>

    <!-- Review System Section -->
    <div id="reviewSection">
        <script>
            // Adicionar seção de reviews ao DOM
            document.addEventListener('DOMContentLoaded', function() {
                if (typeof reviewSystem !== 'undefined') {
                    const reviewSection = reviewSystem.createReviewSection('golden-sakura', 'LAIKOU Vitamin C 24K Golden Sakura');
                    document.body.insertAdjacentHTML('beforeend', reviewSection);
                    reviewSystem.loadExistingReviews();
                }
            });
        </script>
    </div>

    <!-- Modal de Login -->
    <div id="loginModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 400px; width: 90%; text-align: center;">
            <h3 style="color: #d4af37; margin-bottom: 20px;" data-translate-key="login_title"><i class="fas fa-user"></i> Login</h3>
            <form id="loginForm">
                <div style="margin-bottom: 15px;">
                    <input type="email" id="loginEmail" data-translate-key="email_placeholder" placeholder="Your email" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <input type="password" id="loginPassword" data-translate-key="password_placeholder" placeholder="Your password" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                </div>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button type="submit" data-translate-key="login_btn" style="background: #d4af37; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">Login</button>
                    <button type="button" id="closeLoginModal" data-translate-key="cancel_btn" style="background: #666; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Review Modal -->
    <div id="reviewModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <h3 style="color: #d4af37; margin-bottom: 20px;" data-translate-key="add_review_title"><i class="fas fa-star"></i> Add Review</h3>
            <form id="reviewForm">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;" data-translate-key="your_name_label">Your Name:</label>
                    <input type="text" id="reviewerName" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;" data-translate-key="rating_label">Rating:</label>
                    <div id="starRating" style="display: flex; gap: 5px; justify-content: center; margin: 10px 0;">
                        <i class="fas fa-star" data-rating="1" style="font-size: 24px; color: #ddd; cursor: pointer; transition: color 0.3s;"></i>
                        <i class="fas fa-star" data-rating="2" style="font-size: 24px; color: #ddd; cursor: pointer; transition: color 0.3s;"></i>
                        <i class="fas fa-star" data-rating="3" style="font-size: 24px; color: #ddd; cursor: pointer; transition: color 0.3s;"></i>
                        <i class="fas fa-star" data-rating="4" style="font-size: 24px; color: #ddd; cursor: pointer; transition: color 0.3s;"></i>
                        <i class="fas fa-star" data-rating="5" style="font-size: 24px; color: #ddd; cursor: pointer; transition: color 0.3s;"></i>
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;" data-translate-key="your_review_label">Your Review:</label>
                    <textarea id="reviewText" required data-translate-key="review_placeholder" placeholder="Tell us about your experience with the product..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; min-height: 100px; resize: vertical;"></textarea>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;" data-translate-key="photo_optional_label">Photo (optional):</label>
                    <input type="file" id="reviewImage" accept="image/*" style="width: 100%; padding: 8px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
                    <div id="imagePreview" style="margin-top: 10px; text-align: center;"></div>
                </div>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button type="submit" data-translate-key="submit_review_btn" style="background: #d4af37; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">Submit Review</button>
                    <button type="button" id="closeReviewModal" data-translate-key="cancel_btn" style="background: #666; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Review System JavaScript -->
    <script>
        // Sistema de Reviews
        let currentUser = null;
        let userReviews = JSON.parse(localStorage.getItem('userReviews')) || [];
        let selectedRating = 0;

        // Verificar se usuário está logado
        function checkLogin() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                return true;
            }
            return false;
        }

        // Mostrar modal de login
        function showLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
        }

        // Fechar modal de login
        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        // Mostrar modal de review
        function showReviewModal() {
            if (!checkLogin()) {
                showLoginModal();
                return;
            }
            document.getElementById('reviewModal').style.display = 'flex';
        }

        // Fechar modal de review
        function closeReviewModal() {
            document.getElementById('reviewModal').style.display = 'none';
            document.getElementById('reviewForm').reset();
            selectedRating = 0;
            updateStarDisplay();
            document.getElementById('imagePreview').innerHTML = '';
        }


        // Atualizar display das estrelas
        function updateStarDisplay() {
            const stars = document.querySelectorAll('#starRating i');
            stars.forEach((star, index) => {
                if (index < selectedRating) {
                    star.style.color = '#d4af37';
                } else {
                    star.style.color = '#ddd';
                }
            });
        }

            // Event listeners para sistema de reviews
            document.addEventListener('DOMContentLoaded', function() {

                // Botão adicionar review
                const addReviewBtn = document.getElementById('addReviewBtn');
                if (addReviewBtn) {
                    addReviewBtn.addEventListener('click', showReviewModal);
                }

            // Fechar modais
            document.getElementById('closeLoginModal').addEventListener('click', closeLoginModal);
            document.getElementById('closeReviewModal').addEventListener('click', closeReviewModal);

            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                // Simular login (em produção, validar com backend)
                if (email && password) {
                    currentUser = { email: email, name: email.split('@')[0] };
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    closeLoginModal();
                    showReviewModal();
                } else {
                    alert('Please fill in all fields');
                }
            });

            // Sistema de estrelas
            const stars = document.querySelectorAll('#starRating i');
            stars.forEach((star, index) => {
                star.addEventListener('click', function() {
                    selectedRating = index + 1;
                    updateStarDisplay();
                });
                star.addEventListener('mouseenter', function() {
                    for (let i = 0; i <= index; i++) {
                        stars[i].style.color = '#d4af37';
                    }
                });
                star.addEventListener('mouseleave', function() {
                    updateStarDisplay();
                });
            });

            // Preview de imagem
            document.getElementById('reviewImage').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const preview = document.getElementById('imagePreview');
                
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `
                            <img src="${e.target.result}" style="max-width: 200px; max-height: 200px; border-radius: 8px; border: 2px solid #ddd;">
                        `;
                    };
                    reader.readAsDataURL(file);
                } else {
                    preview.innerHTML = '';
                }
            });

            // Formulário de review
            document.getElementById('reviewForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (selectedRating === 0) {
                    alert('Por favor, selecione uma avaliação');
                    return;
                }

                const reviewData = {
                    id: Date.now().toString(),
                    name: document.getElementById('reviewerName').value,
                    rating: selectedRating,
                    text: document.getElementById('reviewText').value,
                    image: null,
                    date: new Date().toLocaleDateString('pt-BR'),
                    verified: true
                };

                // Processar imagem se houver
                const imageFile = document.getElementById('reviewImage').files[0];
                if (imageFile) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        reviewData.image = e.target.result;
                        saveReview(reviewData);
                    };
                    reader.readAsDataURL(imageFile);
                } else {
                    saveReview(reviewData);
                }
            });

            // Carregar reviews existentes
            loadUserReviews();
        });

        // Salvar review
        function saveReview(reviewData) {
            userReviews.push(reviewData);
            localStorage.setItem('userReviews', JSON.stringify(userReviews));
            
            // Adicionar review ao DOM
            addReviewToDOM(reviewData);
            
            closeReviewModal();
            alert('Review adicionada com sucesso!');
        }

        // Adicionar review ao DOM
        function addReviewToDOM(reviewData) {
            const reviewsContainer = document.querySelector('.reviews-container');
            const reviewElement = document.createElement('div');
            reviewElement.className = 'review-item clickable-review';
            reviewElement.setAttribute('data-review-id', reviewData.id);
            reviewElement.setAttribute('data-author', reviewData.name);
            reviewElement.setAttribute('data-date', reviewData.date);
            reviewElement.setAttribute('data-stars', reviewData.rating);
            
            let imageHtml = '';
            if (reviewData.image) {
                imageHtml = `<img src="${reviewData.image}" alt="Review Image" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
            } else {
                imageHtml = `<div class="review-avatar"><i class="fas fa-user"></i></div>`;
            }

            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= reviewData.rating) {
                    starsHtml += '<i class="fas fa-star"></i>';
                } else {
                    starsHtml += '<i class="far fa-star"></i>';
                }
            }

            reviewElement.innerHTML = `
                <div class="review-image">
                    ${imageHtml}
                </div>
                <div class="review-content">
                    <div class="review-stars">
                        ${starsHtml}
                    </div>
                    <p class="review-text">"${reviewData.text}"</p>
                    <div class="review-author">
                        <strong>${reviewData.name}</strong>
                        <span class="review-date">Verified Purchase - ${reviewData.date}</span>
                    </div>
                </div>
            `;

            // Adicionar event listener para o modal
            reviewElement.addEventListener('click', function() {
                openReviewModal(reviewData.name, reviewData.date, reviewData.rating, reviewData.text);
            });

            reviewsContainer.insertBefore(reviewElement, reviewsContainer.firstChild);
        }

        // Carregar reviews do usuário
        function loadUserReviews() {
            userReviews.forEach(review => {
                addReviewToDOM(review);
            });
        }

        // Função para mostrar modal de review completa
        function openReviewModal(author, date, stars, fullText) {
            const existingModal = document.querySelector('.review-modal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modal = document.createElement('div');
            modal.className = 'review-modal';
            
            const starCount = parseFloat(stars);
            let starsHTML = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= starCount) {
                    starsHTML += '<i class="fas fa-star"></i>';
                } else {
                    starsHTML += '<i class="far fa-star"></i>';
                }
            }
            
            modal.innerHTML = `
                <div class="modal-overlay"></div>
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="modal-author-info">
                            <h3>${author}</h3>
                            <div class="modal-stars">
                                ${starsHTML}
                            </div>
                            <div class="modal-date">Verified Purchase - ${date}</div>
                        </div>
                        <button class="modal-close" onclick="closeReviewModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="modal-review-text">"${fullText}"</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Mostrar modal com animação
            setTimeout(() => {
                modal.classList.add('show');
            }, 10);
            
            // Fechar ao clicar no overlay
            modal.addEventListener('click', function(e) {
                if (e.target === modal || e.target.classList.contains('modal-overlay')) {
                    closeReviewModal();
                }
            });
        }
        
        // Função para fechar modal de review
        function closeReviewModal() {
            const modal = document.querySelector('.review-modal');
            if (modal) {
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }
        
        // Função para gerar HTML das estrelas
        function generateStarsHTML(rating) {
            let starsHTML = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    starsHTML += '<i class="fas fa-star"></i>';
                } else {
                    starsHTML += '<i class="far fa-star"></i>';
                }
            }
            return starsHTML;
        }
    </script>

    <script>
        // Payment method control
        function setupPaymentMethodControl() {
            const paymentMethodSelect = document.getElementById('paymentMethod');
            const paypalButton = document.getElementById('paypal-payment-button');
            const pixInfo = document.getElementById('pix-payment-info');
            
            if (paymentMethodSelect) {
                paymentMethodSelect.addEventListener('change', function() {
                    const selectedMethod = this.value;
                    
                    // Hide all payment options first
                    if (paypalButton) paypalButton.style.display = 'none';
                    if (pixInfo) pixInfo.style.display = 'none';
                    
                    // Show selected payment method
                    switch(selectedMethod) {
                        case 'paypal':
                            if (paypalButton) paypalButton.style.display = 'block';
                            break;
                        case 'pix':
                            if (pixInfo) pixInfo.style.display = 'block';
                            break;
                    }
                });
            }
        }
        
        // Global variables for PayPal currency and locale
        let currentPayPalCurrency = 'USD';
        let currentPayPalLocale = 'en_US';
        
        // Setup PIX only for Brazilian customers
        function setupPIXForBrazilOnly() {
            const userLanguage = navigator.language || navigator.userLanguage;
            const pixOption = document.getElementById('pix-option');
            
            // Check for test mode (Angolan testing)
            const isTestMode = localStorage.getItem('pixTestMode') === 'true';
            const isAngolan = userLanguage.startsWith('pt') && !userLanguage.includes('BR') && !userLanguage.includes('PT');
            
            // Show PIX for Brazilian Portuguese (pt-BR) OR for Angolan in test mode
            if (userLanguage.startsWith('pt-BR') || userLanguage.startsWith('pt_BR') || (isAngolan && isTestMode)) {
                if (pixOption) {
                    pixOption.style.display = 'block';
                    if (isAngolan && isTestMode) {
                        console.log('🇦🇴 Angolan testing PIX - Test mode enabled');
                        pixOption.textContent = 'PIX (Test Mode)';
                    } else {
                        console.log('🇧🇷 Brazilian customer detected - PIX enabled');
                    }
                }
            } else {
                if (pixOption) {
                    pixOption.style.display = 'none';
                    console.log('🌍 Non-Brazilian customer - PIX disabled');
                }
            }
        }
        
        // Test function for Angolan to enable PIX testing
        function enablePIXTestMode() {
            localStorage.setItem('pixTestMode', 'true');
            setupPIXForBrazilOnly();
            console.log('🧪 PIX Test Mode enabled for Angolan testing');
            alert('PIX Test Mode enabled! You can now test PIX functionality.');
        }
        
        // Disable test mode
        function disablePIXTestMode() {
            localStorage.removeItem('pixTestMode');
            setupPIXForBrazilOnly();
            console.log('🧪 PIX Test Mode disabled');
            alert('PIX Test Mode disabled. PIX will only show for Brazilian customers.');
        }

        // Function to get current currency for order creation
        function getCurrentCurrency() {
            return currentPayPalCurrency;
        }
        
        // Initialize payment method control and PayPal
        document.addEventListener('DOMContentLoaded', function() {
            setupPaymentMethodControl();
            loadPayPalWithCorrectLocale();
            setupPIXForBrazilOnly();
            
            // Add test functions to global scope for console testing
            window.enablePIXTestMode = enablePIXTestMode;
            window.disablePIXTestMode = disablePIXTestMode;
            window.testPIX = function() {
                console.log('🧪 PIX Test Functions Available:');
                console.log('enablePIXTestMode() - Enable PIX for Angolan testing');
                console.log('disablePIXTestMode() - Disable PIX test mode');
                console.log('Current test mode:', localStorage.getItem('pixTestMode'));
            };
            
            // Show test info in console
            console.log('🧪 PIX Test Mode Available!');
            console.log('Type: testPIX() for available functions');
        });

        // Load PayPal SDK with correct locale and currency based on user's language
        function loadPayPalWithCorrectLocale() {
            // Detect user's language and currency
            const userLanguage = navigator.language || navigator.userLanguage;
            let paypalLocale = 'en_US'; // Default to English
            let paypalCurrency = 'USD'; // Default to USD
            
            // Map browser language to PayPal locale and currency
            if (userLanguage.startsWith('pt')) {
                if (userLanguage.includes('BR') || userLanguage.includes('br')) {
                    paypalLocale = 'pt_BR'; // Portuguese Brazil
                    paypalCurrency = 'BRL'; // Brazilian Real
                } else if (userLanguage.includes('PT') || userLanguage.includes('pt')) {
                    paypalLocale = 'pt_PT'; // Portuguese Portugal
                    paypalCurrency = 'EUR'; // Euro
                } else {
                    // Generic Portuguese (Angola, etc.) - use USD
                    paypalLocale = 'pt_PT'; // Portuguese interface
                    paypalCurrency = 'USD'; // US Dollar for international Portuguese speakers
                }
            } else if (userLanguage.startsWith('en')) {
                paypalLocale = 'en_US'; // English US
                paypalCurrency = 'USD'; // US Dollar
            } else if (userLanguage.startsWith('es')) {
                paypalLocale = 'es_ES'; // Spanish
                paypalCurrency = 'EUR'; // Euro for Spain
            } else if (userLanguage.startsWith('fr')) {
                paypalLocale = 'fr_FR'; // French
                paypalCurrency = 'EUR'; // Euro for France
            } else if (userLanguage.startsWith('de')) {
                paypalLocale = 'de_DE'; // German
                paypalCurrency = 'EUR'; // Euro for Germany
            }
            
            console.log('Detected language:', userLanguage, 'Using PayPal locale:', paypalLocale, 'Currency:', paypalCurrency);
            
            // Store globally for use in order creation
            currentPayPalCurrency = paypalCurrency;
            currentPayPalLocale = paypalLocale;
            
            // Load PayPal SDK with correct locale and currency
            const script = document.createElement('script');
            script.src = `https://www.paypal.com/sdk/js?client-id=Ab2ftZVJCplquKwOY1cWgvWMivADwMhbUs-OhehwO4hVh_VW9lS87qLkRUVD39yEeoh7YGXzBeuq1Dlh&currency=${paypalCurrency}&intent=capture&locale=${paypalLocale}`;
            script.onload = function() {
                console.log('PayPal SDK loaded with locale:', paypalLocale, 'and currency:', paypalCurrency);
                initializePayPal();
            };
            script.onerror = function() {
                console.error('Failed to load PayPal SDK');
                // Try with a simpler URL
                console.log('Retrying with simpler PayPal SDK URL...');
                const retryScript = document.createElement('script');
                retryScript.src = 'https://www.paypal.com/sdk/js?client-id=Ab2ftZVJCplquKwOY1cWgvWMivADwMhbUs-OhehwO4hVh_VW9lS87qLkRUVD39yEeoh7YGXzBeuq1Dlh&currency=USD&intent=capture';
                retryScript.async = true;
                retryScript.defer = true;
                retryScript.onload = function() {
                    console.log('PayPal SDK loaded with fallback URL');
                    setTimeout(initializePayPal, 500);
                };
                retryScript.onerror = function() {
                    console.error('PayPal SDK failed to load even with fallback URL');
                };
                document.head.appendChild(retryScript);
            };
            document.head.appendChild(script);
        }

        // PayPal integration
        let paypalRetryCount = 0;
        const maxPaypalRetries = 50; // Maximum 5 seconds (50 * 100ms)
        
        function initializePayPal() {
            // Wait for PayPal SDK to be loaded
            if (typeof paypal === 'undefined') {
                paypalRetryCount++;
                if (paypalRetryCount < maxPaypalRetries) {
                console.log('PayPal SDK not loaded yet, retrying...');
                setTimeout(initializePayPal, 100);
                return;
                } else {
                    console.error('PayPal SDK failed to load after maximum retries');
                    return;
                }
            }

            console.log('PayPal SDK loaded, initializing buttons...');

            // Clear any existing buttons
            const paypalContainer = document.getElementById('paypal-payment-button');
            if (paypalContainer) {
                paypalContainer.innerHTML = '';
            }

        paypal.Buttons({
            locale: currentPayPalLocale,
            style: {
                locale: currentPayPalLocale,
                color: 'gold',
                shape: 'rect',
                label: 'paypal'
            },
            createOrder: function(data, actions) {
                    return new Promise((resolve, reject) => {
                        try {
                            // Validate required variables
                            if (!selectedOffers || !Array.isArray(selectedOffers) || selectedOffers.length === 0) {
                                throw new Error('No offers selected');
                            }
                            
                            if (!currentCurrency) {
                                currentCurrency = 'USD'; // Fallback
                            }
                            
                            // Get total from order summary (use same currency as summary)
                            const totalElement = document.getElementById('totalAmount');
                            let totalAmount = 0;
                            
                            console.log('🔍 PayPal Debug - totalElement found:', !!totalElement);
                            if (totalElement) {
                                const totalText = totalElement.textContent;
                                console.log('🔍 PayPal Debug - totalText:', totalText);
                                const totalValue = parseFloat(totalText.replace(/[^\d.,]/g, '').replace(',', '.'));
                                console.log('🔍 PayPal Debug - totalValue:', totalValue);
                                
                                // Use the same currency as the summary (no conversion)
                                totalAmount = totalValue;
                                console.log('🔍 PayPal Debug - Using HTML totalAmount:', totalAmount);
                                } else {
                                console.log('🔍 PayPal Debug - totalElement NOT found, using fallback');
                                // Fallback to calculation
                                console.log('🔍 PayPal Debug - Using fallback calculation');
                                totalAmount = selectedOffers.reduce((total, offerType) => {
                                    if (!offers[offerType]) {
                                        console.warn('Offer not found:', offerType);
                                        return total;
                                    }
                                    
                                    const price = offers[offerType].prices && offers[offerType].prices[currentCurrency] 
                                        ? offers[offerType].prices[currentCurrency] 
                                        : offers[offerType].price || 0;
                                    
                                    return total + price;
                                }, 0);
                                console.log('🔍 PayPal Debug - Fallback calculated totalAmount:', totalAmount);
                            }
                            
                            const productNames = selectedOffers.map(offerType => 
                                offers[offerType] ? offers[offerType].name : 'Produto'
                            ).join(' + ');
                            
                            console.log('PayPal order creation:', {
                                selectedOffers: selectedOffers,
                                totalAmount: totalAmount,
                                currency: currentCurrency,
                                productNames: productNames
                            });
                            
                            console.log('🔍 PayPal Debug - Final totalAmount being sent to PayPal:', totalAmount);
                            if (totalAmount <= 0) {
                                throw new Error('Invalid total amount: ' + totalAmount);
                            }
                            
                            // Create order with timeout
                            const orderPromise = actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: totalAmount.toFixed(2),
                            currency_code: getCurrentCurrency()
                        },
                                    description: productNames || 'LAIKOU Skincare Products'
                                }]
                            });
                            
                            // Add timeout to prevent hanging
                            const timeoutPromise = new Promise((_, timeoutReject) => {
                                setTimeout(() => {
                                    timeoutReject(new Error('PayPal order creation timeout'));
                                }, 8000);
                            });
                            
                            Promise.race([orderPromise, timeoutPromise])
                                .then(resolve)
                                .catch(reject);
                                
                        } catch (error) {
                            console.error('Error creating PayPal order:', error);
                            reject(error);
                        }
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(details) {
                        console.log('PayPal payment approved:', details);
                    alert('Pagamento aprovado! ID da transação: ' + details.id);
                    processCheckout();
                    }).catch(function(error) {
                        console.error('PayPal payment error:', error);
                        alert('Erro no processamento do pagamento. Tente novamente.');
                    });
                },
                onError: function(err) {
                    console.error('PayPal error:', err);
                    alert('Erro no PayPal. Tente novamente ou escolha outra forma de pagamento.');
                },
                onCancel: function(data) {
                    console.log('PayPal payment cancelled:', data);
                }
            }).render('#paypal-payment-button').then(function() {
                console.log('PayPal buttons rendered successfully');
            }).catch(function(error) {
                console.error('Error rendering PayPal buttons:', error);
                // Retry after a delay
                setTimeout(() => {
                    console.log('Retrying PayPal button initialization...');
                    initializePayPal();
                }, 2000);
            });
        }
    </script>

    <script>
        // Função para formatar preço
        function formatPrice(price) {
            if (currentCurrency === 'BRL') {
                return `R$ ${price.toFixed(2).replace('.', ',')}`;
            } else if (currentCurrency === 'EUR') {
                return `€${price.toFixed(2)}`;
            } else {
                return `$${price.toFixed(2)}`;
            }
        }

        // Função de processamento de checkout
        function processCheckout() {
            const email = document.getElementById('email').value;
            const paymentMethod = document.getElementById('paymentMethod').value;
            const observations = document.getElementById('observations').value;

            if (!paymentMethod) {
                alert('Por favor, selecione uma forma de pagamento.');
                return;
            }
            
            // Validate payment method selection
            if (!['paypal', 'pix'].includes(paymentMethod)) {
                alert('Por favor, selecione uma forma de pagamento válida (PayPal ou PIX).');
                return;
            }
            
            // Validate email only for PIX payments
            if (paymentMethod === 'pix') {
                if (!email) {
                    alert('Por favor, preencha o email para receber as instruções de pagamento PIX.');
                    return;
                }
                
                // Validate email format
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    alert('Por favor, insira um email válido.');
                    return;
                }
            }
            
            // Validate selected offers
            if (!selectedOffers || selectedOffers.length === 0) {
                alert('Por favor, selecione pelo menos um produto.');
                return;
            }
            
            // Validate currency
            if (!currentCurrency) {
                currentCurrency = 'USD'; // Fallback
            }
            
            const orderData = {
                id: 'ORDER_' + Date.now(),
                products: selectedOffers.map(offerType => {
                    if (!offers[offerType]) {
                        console.error('Offer not found:', offerType);
                        return null;
                    }
                    return {
                    ...offers[offerType],
                        totalPrice: offers[offerType].prices[currentCurrency] || offers[offerType].price || 0
                    };
                }).filter(product => product !== null),
                customer: {
                    email: email || 'paypal@customer.com'
                },
                paymentMethod,
                observations,
                total: selectedOffers.reduce((total, offerType) => {
                    if (!offers[offerType]) {
                        console.warn('Offer not found for total calculation:', offerType);
                        return total;
                    }
                    const price = offers[offerType].prices && offers[offerType].prices[currentCurrency] 
                        ? offers[offerType].prices[currentCurrency] 
                        : offers[offerType].price || 0;
                    return total + price;
                }, 0),
                date: new Date().toISOString()
            };
            
            // Validate that we have valid products
            if (orderData.products.length === 0) {
                alert('Erro: Nenhum produto válido encontrado. Tente novamente.');
                return;
            }
            
            // Map order for supplier (AliExpress)
            let mappedOrder = null;
            if (typeof mapProductOrder === 'function') {
                try {
                    // Prepare order data for mapping
                    const mappingOrderData = {
                        id: orderData.id,
                        customer: orderData.customer,
                        items: orderData.products.map(product => ({
                            productId: 'laikou_golden_sakura',
                            name: product.name,
                            variation: product.selectedType ? {
                                type: 'type',
                                value: product.selectedType.name,
                                displayName: product.selectedType.name
                            } : null,
                            quantity: 1,
                            unitPrice: product.totalPrice,
                            totalPrice: product.totalPrice
                        })),
                        total: orderData.total,
                        date: orderData.date
                    };
                    
                    // Map the order
                    mappedOrder = mapProductOrder(mappingOrderData);
                    console.log('Pedido mapeado para fornecedor:', mappedOrder);
                } catch (error) {
                    console.error('Erro ao mapear pedido:', error);
                }
            }
            
            // Save original order
            let orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(orderData);
            localStorage.setItem('orders', JSON.stringify(orders));
            
            // Save mapped order to dashboardData for dashboard synchronization
            let dashboardData = JSON.parse(localStorage.getItem('dashboardData') || '{}');
            if (!dashboardData.orders) dashboardData.orders = [];
            
            // Use mapped order if available, otherwise use original
            const orderToSave = mappedOrder || orderData;
            dashboardData.orders.push(orderToSave);
            localStorage.setItem('dashboardData', JSON.stringify(dashboardData));
            
            // Show specific message based on payment method
            let successMessage = `Order placed successfully!\n\nProducts: ${orderData.products.map(p => p.name).join(' + ')}\nTotal: ${formatPrice(orderData.total)}\n\n`;
            
            switch(paymentMethod) {
                case 'paypal':
                    successMessage += 'O pagamento via PayPal foi processado. Você receberá um email de confirmação em breve.';
                    break;
                case 'pix':
                    successMessage += 'Você receberá as instruções de pagamento PIX por email. Após o pagamento, seu pedido será processado.';
                    break;
                default:
                    successMessage += 'Você receberá um email de confirmação em breve.';
            }
            
            alert(successMessage);
            
            // Redirect to home page
            window.location.href = '../../index.html';
        }
    </script>

    <!-- Sistema de Tradução -->
    <script>
        class CheckoutTranslator {
            constructor() {
                this.userLanguage = 'en';
                this.userCountry = 'Unknown';
                this.userCurrency = 'USD';
                this.init();
            }
            
            async init() {
                await this.detectUserLocation();
                this.updatePageContent();
            }
            
            async detectUserLocation() {
                try {
                    let countryCode = null;
                    
                    // ALWAYS detect browser language first for maximum user experience
                    const browserLang = navigator.language || navigator.userLanguage;
                    console.log('🌍 Browser Language Detected:', browserLang);
                    
                    if (browserLang.startsWith('pt-BR') || browserLang.startsWith('pt_BR')) {
                        this.userLanguage = 'pt-BR'; // Brazilian Portuguese
                        console.log('🇧🇷 Brazilian Portuguese detected');
                    } else if (browserLang.startsWith('pt-PT') || browserLang.startsWith('pt_PT')) {
                        this.userLanguage = 'pt-PT'; // European Portuguese
                        console.log('🇵🇹 European Portuguese detected');
                    } else if (browserLang.startsWith('pt')) {
                        // Generic Portuguese - default to European Portuguese (Portugal focus)
                        this.userLanguage = 'pt-PT';
                        console.log('🇵🇹 Generic Portuguese detected - defaulting to European Portuguese');
                    } else {
                        this.userLanguage = 'en';
                        console.log('🇺🇸 English language detected');
                    }
                    
                    // Check if running from file:// protocol
                    if (window.location.protocol === 'file:') {
                        console.log('Running from file:// protocol, using fallback detection');
                        if (this.userLanguage === 'pt') {
                            countryCode = 'BR';
                            console.log('Detected Portuguese language, assuming Brazil');
                        } else {
                            countryCode = 'US';
                            console.log('Using default US location');
                        }
                    } else {
                        // Use ONLY browser language - NO IP detection
                        const browserLang = navigator.language || navigator.userLanguage;
                        console.log('🌍 Browser language detected:', browserLang);
                        
                        // Set language and currency based ONLY on browser language
                        if (browserLang.startsWith('pt-PT') || browserLang.startsWith('pt_PT')) {
                            this.userLanguage = 'pt';
                            this.userCountry = 'PT';
                            this.userCurrency = 'EUR';
                            console.log('🇵🇹 Portuguese (Portugal) detected → EUR');
                        } else if (browserLang.startsWith('pt-BR') || browserLang.startsWith('pt_BR')) {
                            this.userLanguage = 'pt';
                            this.userCountry = 'BR';
                            this.userCurrency = 'BRL';
                            console.log('🇧🇷 Portuguese (Brazil) detected → BRL');
                        } else if (browserLang.startsWith('pt')) {
                            // Generic Portuguese - default to USD (for Angola and other Portuguese-speaking countries)
                            this.userLanguage = 'pt';
                            this.userCountry = 'AO'; // Angola
                            this.userCurrency = 'USD';
                            console.log('🇦🇴 Generic Portuguese detected → USD (Angola/International)');
                        } else {
                            this.userLanguage = 'en';
                            this.userCountry = 'US';
                            this.userCurrency = 'USD';
                            console.log('🇺🇸 English detected → USD');
                        }
                    }
                    
                    this.userCountry = countryCode;
                    
                    const countryToCurrency = {
                        'BR': 'BRL',
                        'AO': 'USD',  // Angola → Dólar (padrão)
                        'US': 'USD', 'CA': 'USD', 'MX': 'USD', 'AR': 'USD', 'CL': 'USD', 'CO': 'USD', 'PE': 'USD', 'UY': 'USD', 'BO': 'USD', 'PY': 'USD', 'VE': 'USD', 'EC': 'USD', 'GY': 'USD', 'SR': 'USD', 'GF': 'USD', 'FK': 'USD', 'BZ': 'USD', 'GT': 'USD', 'HN': 'USD', 'SV': 'USD', 'NI': 'USD', 'CR': 'USD', 'PA': 'USD', 'CU': 'USD', 'JM': 'USD', 'HT': 'USD', 'DO': 'USD', 'PR': 'USD', 'VI': 'USD', 'AG': 'USD', 'BB': 'USD', 'DM': 'USD', 'GD': 'USD', 'KN': 'USD', 'LC': 'USD', 'VC': 'USD', 'TT': 'USD', 'BS': 'USD', 'AU': 'USD', 'NZ': 'USD', 'JP': 'USD', 'KR': 'USD', 'SG': 'USD', 'HK': 'USD', 'TW': 'USD', 'TH': 'USD', 'MY': 'USD', 'ID': 'USD', 'PH': 'USD', 'VN': 'USD', 'IN': 'USD', 'PK': 'USD', 'BD': 'USD', 'LK': 'USD', 'MM': 'USD', 'KH': 'USD', 'LA': 'USD', 'BN': 'USD', 'FJ': 'USD', 'PG': 'USD', 'SB': 'USD', 'VU': 'USD', 'NC': 'USD', 'PF': 'USD', 'WS': 'USD', 'TO': 'USD', 'KI': 'USD', 'TV': 'USD', 'NR': 'USD', 'MH': 'USD', 'FM': 'USD', 'PW': 'USD', 'AS': 'USD', 'GU': 'USD', 'MP': 'USD', 'CK': 'USD', 'NU': 'USD', 'TK': 'USD', 'WF': 'USD', 'NF': 'USD', 'PN': 'USD', 'GS': 'USD', 'SH': 'USD', 'AC': 'USD', 'TA': 'USD', 'IO': 'USD', 'CX': 'USD', 'CC': 'USD', 'HM': 'USD', 'AQ': 'USD', 'BV': 'USD', 'TF': 'USD', 'UM': 'USD',
                        'DE': 'EUR', 'FR': 'EUR', 'IT': 'EUR', 'ES': 'EUR', 'NL': 'EUR', 'BE': 'EUR', 'AT': 'EUR', 'PT': 'EUR', 'IE': 'EUR', 'FI': 'EUR', 'GR': 'EUR', 'LU': 'EUR', 'MT': 'EUR', 'CY': 'EUR', 'SK': 'EUR', 'SI': 'EUR', 'EE': 'EUR', 'LV': 'EUR', 'LT': 'EUR', 'AD': 'EUR', 'MC': 'EUR', 'SM': 'EUR', 'VA': 'EUR', 'ME': 'EUR', 'XK': 'EUR'
                    };
                    
                    this.userCurrency = countryToCurrency[this.userCountry] || 'USD';
                    console.log(`Final detection - Country: ${this.userCountry}, Currency: ${this.userCurrency}`);
                    
                } catch (error) {
                    console.error('Error in location detection:', error);
                    this.userCurrency = 'USD';
                    this.userCountry = 'Unknown';
                }
            }
            
            translateContent(contentKey) {
                // Use detected language for content translation - distinguish between Brazilian and European Portuguese
                let languageKey = 'USD'; // Default to English

                if (this.userLanguage === 'pt-PT' || this.userLanguage === 'pt_PT') {
                    languageKey = 'EUR'; // European Portuguese for Portugal
                    console.log(`🇵🇹 European Portuguese detected for ${contentKey}`);
                } else if (this.userLanguage === 'pt-BR' || this.userLanguage === 'pt_BR') {
                    languageKey = 'BRL'; // Brazilian Portuguese
                    console.log(`🇧🇷 Brazilian Portuguese detected for ${contentKey}`);
                } else if (this.userLanguage === 'pt-AO' || this.userLanguage === 'pt_AO') {
                    languageKey = 'EUR'; // Angolan Portuguese → European Portuguese (Portugal focus)
                    console.log(`🇦🇴 Angolan Portuguese detected for ${contentKey} - using European Portuguese`);
                } else if (this.userLanguage === 'pt') {
                    languageKey = 'EUR'; // Generic Portuguese defaults to European (Portugal focus)
                    console.log(`🇵🇹 Generic Portuguese detected for ${contentKey} - defaulting to European Portuguese`);
                } else {
                    languageKey = 'USD'; // English for other languages
                    console.log(`🇺🇸 English detected for ${contentKey}`);
                }

                console.log(`🌍 Translating ${contentKey}: userLanguage=${this.userLanguage}, languageKey=${languageKey}`);
                
                const translations = {
                    'checkout_title': {
                        'USD': 'Checkout',
                        'BRL': 'Finalizar Compra',
                        'EUR': 'Finalizar Compra'
                    },
                    'product_info': {
                        'USD': 'Product Information',
                        'BRL': 'Informações do Produto',
                        'EUR': 'Informações do Produto'
                    },
                    'customer_info': {
                        'USD': 'Customer Information',
                        'BRL': 'Informações do Cliente',
                        'EUR': 'Informações do Cliente'
                    },
                    'payment_info': {
                        'USD': 'Payment Information',
                        'BRL': 'Informações de Pagamento',
                        'EUR': 'Informações de Pagamento'
                    },
                    'order_summary': {
                        'USD': 'Order Summary',
                        'BRL': 'Resumo do Pedido',
                        'EUR': 'Resumo do Pedido'
                    },
                    'first_name': {
                        'USD': 'First Name',
                        'BRL': 'Nome',
                        'EUR': 'Nome'
                    },
                    'last_name': {
                        'USD': 'Last Name',
                        'BRL': 'Sobrenome',
                        'EUR': 'Sobrenome'
                    },
                    'email': {
                        'USD': 'Email',
                        'BRL': 'E-mail',
                        'EUR': 'E-mail'
                    },
                    'phone': {
                        'USD': 'Phone',
                        'BRL': 'Telefone',
                        'EUR': 'Telefone'
                    },
                    'address': {
                        'USD': 'Address',
                        'BRL': 'Endereço',
                        'EUR': 'Endereço'
                    },
                    'city': {
                        'USD': 'City',
                        'BRL': 'Cidade',
                        'EUR': 'Cidade'
                    },
                    'state': {
                        'USD': 'State',
                        'BRL': 'Estado',
                        'EUR': 'Estado'
                    },
                    'zip_code': {
                        'USD': 'Zip Code',
                        'BRL': 'CEP',
                        'EUR': 'CEP'
                    },
                    'country': {
                        'USD': 'Country',
                        'BRL': 'País',
                        'EUR': 'País'
                    },
                    'payment_method': {
                        'USD': 'Payment Method',
                        'BRL': 'Método de Pagamento',
                        'EUR': 'Método de Pagamento'
                    },
                    'observations': {
                        'USD': 'Observations',
                        'BRL': 'Observações',
                        'EUR': 'Observações'
                    },
                    'total': {
                        'USD': 'Total',
                        'BRL': 'Total',
                        'EUR': 'Total'
                    },
                    'checkout_button': {
                        'USD': 'Complete Purchase',
                        'BRL': 'Finalizar Compra',
                        'EUR': 'Finalizar Compra'
                    },
                    'required_fields': {
                        'USD': 'Please fill in all required fields.',
                        'BRL': 'Please fill in all fields obrigatórios.',
                        'EUR': 'Please fill in all fields obrigatórios.'
                    },
                    'order_success': {
                        'USD': 'Order completed successfully!',
                        'BRL': 'Order placed successfully!',
                        'EUR': 'Order placed successfully!'
                    },
                    'confirmation_email': {
                        'USD': 'You will receive a confirmation email shortly.',
                        'BRL': 'Você receberá um e-mail de confirmação em breve.',
                        'EUR': 'Você receberá um e-mail de confirmação em breve.'
                    },
                    // Product name translations
                    'product_laiou_skincare': {
                        'USD': '24K Anti-Aging Kit',
                        'BRL': 'LAIKOU Cuidados da Pele',
                        'EUR': '24K Anti-Aging Kit'
                    },
                    // Offer interface translations
                    'offer_basic_title': {
                        'USD': 'Basic Offer',
                        'BRL': 'Oferta Básica',
                        'EUR': 'Oferta Básica'
                    },
                    'offer_basic_description': {
                        'USD': 'Tired of dull and dry skin? LAIKOU hydrates, nourishes and restores natural softness, leaving your skin healthier and radiant every day.',
                        'BRL': 'Cansada de pele sem brilho e ressecada? LAIKOU hidrata, nutre e devolve a maciez natural, deixando sua pele mais saudável e radiante todos os dias.',
                        'EUR': 'Tired of dull and dry skin? LAIKOU hydrates, nourishes and restores natural softness, leaving your skin healthier and radiant every day.'
                    },
                    'choose_variant': {
                        'USD': 'Choose your variant:',
                        'BRL': 'Choose your variant:',
                        'EUR': 'Choose your variant:'
                    },
                    'discount_badge': {
                        'USD': '70% OFF',
                        'BRL': '70% OFF',
                        'EUR': '70% OFF'
                    }
                };
                
                return translations[contentKey] ? 
                    translations[contentKey][languageKey] || 
                    translations[contentKey]['USD'] : 
                    contentKey;
            }
            
            updatePageContent() {
                try {
                    // Update page title
                    const pageTitle = document.querySelector('title');
                    if (pageTitle) {
                        pageTitle.textContent = `${this.translateContent('checkout_title')} - ${this.translateContent('product_laiou_skincare')} | 67 Beauty Hub`;
                    }
                    
                    // Update form labels
                    const firstNameLabel = document.querySelector('label[for="firstName"]');
                    if (firstNameLabel) firstNameLabel.textContent = this.translateContent('first_name');
                    
                    const lastNameLabel = document.querySelector('label[for="lastName"]');
                    if (lastNameLabel) lastNameLabel.textContent = this.translateContent('last_name');
                    
                    const emailLabel = document.querySelector('label[for="email"]');
                    if (emailLabel) emailLabel.textContent = this.translateContent('email');
                    
                    const phoneLabel = document.querySelector('label[for="phone"]');
                    if (phoneLabel) phoneLabel.textContent = this.translateContent('phone');
                    
                    const addressLabel = document.querySelector('label[for="address"]');
                    if (addressLabel) addressLabel.textContent = this.translateContent('address');
                    
                    const cityLabel = document.querySelector('label[for="city"]');
                    if (cityLabel) cityLabel.textContent = this.translateContent('city');
                    
                    const stateLabel = document.querySelector('label[for="state"]');
                    if (stateLabel) stateLabel.textContent = this.translateContent('state');
                    
                    const zipCodeLabel = document.querySelector('label[for="zipCode"]');
                    if (zipCodeLabel) zipCodeLabel.textContent = this.translateContent('zip_code');
                    
                    const countryLabel = document.querySelector('label[for="country"]');
                    if (countryLabel) countryLabel.textContent = this.translateContent('country');
                    
                    const paymentLabel = document.querySelector('label[for="paymentMethod"]');
                    if (paymentLabel) paymentLabel.textContent = this.translateContent('payment_method');
                    
                    const observationsLabel = document.querySelector('label[for="observations"]');
                    if (observationsLabel) observationsLabel.textContent = this.translateContent('observations');
                    
                    // Update placeholders
                    const firstNameInput = document.getElementById('firstName');
                    if (firstNameInput) firstNameInput.placeholder = this.translateContent('first_name');
                    
                    const lastNameInput = document.getElementById('lastName');
                    if (lastNameInput) lastNameInput.placeholder = this.translateContent('last_name');
                    
                    const emailInput = document.getElementById('email');
                    if (emailInput) emailInput.placeholder = this.translateContent('email');
                    
                    const observationsInput = document.getElementById('observations');
                    if (observationsInput) observationsInput.placeholder = this.translateContent('observations');
                    
                    // Update checkout button
                    const checkoutButton = document.querySelector('button[onclick="processCheckout()"]');
                    if (checkoutButton) checkoutButton.textContent = this.translateContent('checkout_button');
                    
                    // Update product title
                    const productTitle = document.querySelector('h3[data-translate-key="product_laiou_skincare"]');
                    if (productTitle) productTitle.textContent = this.translateContent('product_laiou_skincare');
                    
                    // Update offer elements
                    const offerBasicTitle = document.querySelector('h3[data-translate-key="offer_basic_title"]');
                    if (offerBasicTitle) {
                        offerBasicTitle.innerHTML = `<i class="fas fa-gift"></i> ${this.translateContent('offer_basic_title')}`;
                    }
                    
                    const productTitleInOffer = document.querySelector('h4[data-translate-key="product_laiou_skincare"]');
                    if (productTitleInOffer) productTitleInOffer.textContent = this.translateContent('product_laiou_skincare');
                    
                    const offerDescription = document.querySelector('.description[data-translate-key="offer_basic_description"]');
                    if (offerDescription) offerDescription.textContent = this.translateContent('offer_basic_description');
                    
                    // Update order summary title
                    const orderSummaryTitle = document.querySelector('span[data-translate-key="order_summary"]');
                    if (orderSummaryTitle) orderSummaryTitle.textContent = this.translateContent('order_summary');
                    
                    const discountBadge = document.querySelector('.discount[data-translate-key="discount_badge"]');
                    if (discountBadge) discountBadge.textContent = this.translateContent('discount_badge');
                    
                    console.log('Checkout page content updated successfully');
                    
                } catch (error) {
                    console.error('Error updating checkout page content:', error);
                }
            }
        }
        
        // Initialize checkout translator when page loads
        document.addEventListener('DOMContentLoaded', function() {
            new CheckoutTranslator();

            // Add event listeners for flag selection
            document.querySelectorAll('.flag-option').forEach(flag => {
                flag.addEventListener('click', function() {
                    const currency = this.dataset.currency;
                    const flagEmoji = this.dataset.flag;
                    selectFlagOption(currency, flagEmoji);
                });
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                const dropdown = document.querySelector('.flag-dropdown');
                const menu = document.getElementById('flagDropdownMenu');
                if (dropdown && menu && !dropdown.contains(e.target)) {
                    dropdown.classList.remove('open');
                    menu.classList.remove('open');
                }
            });
        });

        // Flag dropdown functions
        function toggleFlagDropdown() {
            const dropdown = document.querySelector('.flag-dropdown');
            const menu = document.getElementById('flagDropdownMenu');
            if (dropdown && menu) {
                dropdown.classList.toggle('open');
                menu.classList.toggle('open');
            }
        }

        function selectFlagOption(currency, flagEmoji) {
            // Update selected flag
            const selectedFlag = document.getElementById('selectedFlag');
            if (selectedFlag) {
                selectedFlag.textContent = flagEmoji;
            }

            // Update current currency
            currentCurrency = currency;

            // Close dropdown
            const dropdown = document.querySelector('.flag-dropdown');
            const menu = document.getElementById('flagDropdownMenu');
            if (dropdown && menu) {
                dropdown.classList.remove('open');
                menu.classList.remove('open');
            }

            // Update all prices
            updateCurrencyDisplay();

            // Save selection to localStorage
            localStorage.setItem('selectedCountry', currency);

            console.log(`Country changed to: ${currency}, Flag: ${flagEmoji}`);
        }
        
        // PIX Payment System
        let pixCheckout = null;
        
        // Initialize PIX system
        function initializePIXSystem() {
            if (typeof PIXCheckout !== 'undefined') {
                pixCheckout = new PIXCheckout();
                console.log('✅ PIX system initialized');
            } else {
                console.error('❌ PIX system not available');
            }
        }
        
        // Setup PIX only for Brazilian customers
        function setupPIXForBrazilOnly() {
            const pixOption = document.getElementById('pix-option');
            const selectedCountry = localStorage.getItem('selectedCountry');
            const isTestMode = localStorage.getItem('pixTestMode') === 'true';
            
            // Debug logs
            console.log('🔍 PIX Debug Info:');
            console.log('Selected Country:', selectedCountry);
            console.log('Is Test Mode:', isTestMode);
            console.log('PIX Option Element:', pixOption);
            
            // Show PIX for Brazil (BR) OR for test mode (any country)
            if (selectedCountry === 'BR' || isTestMode) {
                if (pixOption) {
                    pixOption.style.display = 'block';
                    if (isTestMode) {
                        console.log('🧪 PIX Test Mode enabled');
                        pixOption.textContent = 'PIX (Test Mode)';
                    } else {
                        console.log('🇧🇷 Brazilian customer detected - PIX enabled');
                        pixOption.textContent = 'PIX';
                    }
                } else {
                    console.error('❌ PIX Option element not found!');
                }
            } else {
                if (pixOption) {
                    pixOption.style.display = 'none';
                    console.log('🌍 Non-Brazilian customer - PIX disabled');
                } else {
                    console.error('❌ PIX Option element not found!');
                }
            }
        }
        
        // Enable PIX test mode
        function enablePIXTestMode() {
            localStorage.setItem('pixTestMode', 'true');
            console.log('🧪 PIX Test Mode enabled');
            setupPIXForBrazilOnly();
        }
        
        // Disable PIX test mode
        function disablePIXTestMode() {
            localStorage.removeItem('pixTestMode');
            console.log('🚫 PIX Test Mode disabled');
            setupPIXForBrazilOnly();
        }
        
        // Check current PIX status
        function checkPIXStatus() {
            console.log('🔍 PIX Status Check:');
            console.log('localStorage pixTestMode:', localStorage.getItem('pixTestMode'));
            console.log('User Language:', navigator.language);
            console.log('PIX Option Element:', document.getElementById('pix-option'));
            console.log('PIX Option Display:', document.getElementById('pix-option')?.style.display);
            console.log('PIX Option Text:', document.getElementById('pix-option')?.textContent);
        }
        
        // Initialize PIX for order
        function initializePIXForOrder() {
            if (!pixCheckout) {
                console.error('PIX system not initialized');
                return;
            }
            
            const orderData = getCurrentOrderData();
            if (!orderData) {
                console.error('Failed to get order data for PIX');
                return;
            }
            
            // Initialize PIX with order data
            pixCheckout.initializePIX(orderData);
        }
        
        // Get current order data for PIX (using summary total like PayPal)
        function getCurrentOrderData() {
            // Validate required variables
            if (!selectedOffers || !Array.isArray(selectedOffers) || selectedOffers.length === 0) {
                console.error('No offers selected');
                return null;
            }
            
            // Get total from order summary (same as PayPal logic)
            const totalElement = document.getElementById('totalAmount');
            let totalAmount = 0;
            
            if (totalElement) {
                const totalText = totalElement.textContent;
                totalAmount = parseFloat(totalText.replace(/[^\d.,]/g, '').replace(',', '.'));
                console.log('💰 PIX using summary total:', totalAmount, currentCurrency);
                console.log('📊 Summary element text:', totalText);
            } else {
                console.warn('⚠️ Total element not found, using fallback calculation');
                // Fallback to calculation
                selectedOffers.forEach(offerType => {
                    if (offers[offerType]) {
                        const offer = offers[offerType];
                        const price = offer.prices && offer.prices[currentCurrency] 
                            ? offer.prices[currentCurrency] 
                            : offer.price || 0;
                        totalAmount += price;
                    }
                });
            }
            
            if (totalAmount <= 0) {
                console.error('❌ Invalid total amount:', totalAmount);
                return null;
            }
            
            // Get product names
            const products = selectedOffers.map(offerType => {
                if (offers[offerType]) {
                    let productName = offers[offerType].name;
                    
                    // Se for a oferta básica e há cor selecionada, usar apenas o nome da cor
                    if (offerType === 'basic' && selectedColor) {
                        productName = selectedColor.name;
                    }
                    
                    return productName;
                }
                return 'Produto';
            });
            
            console.log('✅ PIX Order Data:', {
                total: totalAmount,
                currency: currentCurrency,
                products: products
            });
            
            return {
                id: 'ORDER_' + Date.now(),
                products: products,
                total: totalAmount,
                currency: currentCurrency,
                description: products.join(' + ')
            };
        }
        
        // Handle PIX payment
        function handlePIXPayment(email, observations) {
            if (!pixCheckout) {
                alert('PIX system not available. Please try again.');
                return;
            }
            
            const orderData = getCurrentOrderData();
            if (!orderData) {
                alert('Failed to get order data. Please try again.');
                return;
            }
            
            // Initialize PIX with order data
            pixCheckout.initializePIX(orderData);
        }
        
        
        // Payment method control
        function setupPaymentMethodControl() {
            const paymentMethodSelect = document.getElementById('paymentMethod');
            const paypalButton = document.getElementById('paypal-payment-button');
            const pixInfo = document.getElementById('pix-payment-info');
            
            if (paymentMethodSelect) {
                paymentMethodSelect.addEventListener('change', function() {
                    const selectedMethod = this.value;
                    
                    // Hide all payment options first
                    if (paypalButton) paypalButton.style.display = 'none';
                    if (pixInfo) pixInfo.style.display = 'none';
                    
                    // Show selected payment method
                    switch(selectedMethod) {
                        case 'paypal':
                            if (paypalButton) paypalButton.style.display = 'block';
                            break;
                        case 'pix':
                            if (pixInfo) pixInfo.style.display = 'block';
                            initializePIXForOrder();
                            break;
                    }
                });
            }
        }
        
        // Process checkout function
        function processCheckout() {
            const email = document.getElementById('email').value;
            const paymentMethod = document.getElementById('paymentMethod').value;
            const observations = document.getElementById('observations').value;

            if (!email || !paymentMethod) {
                alert('Please fill in email and select a payment method.');
                return;
            }
            
            // Handle PIX payment
            if (paymentMethod === 'pix') {
                handlePIXPayment(email, observations);
                return;
            }
            
            // Handle other payment methods
            alert('Payment method not implemented yet.');
        }
        
        // Initialize PIX system when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setupPaymentMethodControl();
            initializePIXSystem();
            setupPIXForBrazilOnly();
        });
    </script>
    
    <!-- Footer Copyright -->
    <footer style="text-align: center; padding: 20px; background: #f8f9fa; border-top: 1px solid #e9ecef; margin-top: 40px;">
        <p style="color: #666; font-size: 14px; margin: 0;">
            © 2025 67 Beauty Hub - All rights reserved
        </p>
    </footer>


</body>
</html>